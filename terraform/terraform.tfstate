{"version":4,"terraform_version":"1.11.4","serial":4,"lineage":"262bfd78-54e9-f365-24ae-2297da90cd56","outputs":{"asterisk_container_name":{"value":"asterisk-server","type":"string"},"asterisk_ip_address":{"value":"10.100.100.10","type":"string"},"asterisk_network":{"value":"asterisk-net","type":"string"},"connection_info":{"value":{"asterisk_console":"incus exec asterisk-server -- asterisk -rvvv","asterisk_container":"asterisk-server","asterisk_ip":"10.100.100.10","asterisk_logs":"incus exec asterisk-server -- tail -f /var/log/asterisk/messages","provisioning_container":"asterisk-server-provisioning","provisioning_ip":"10.100.100.11","provisioning_url":"http://10.100.100.11","rtp_port_range":"10000-20000","sip_port":5060},"type":["object",{"asterisk_console":"string","asterisk_container":"string","asterisk_ip":"string","asterisk_logs":"string","provisioning_container":"string","provisioning_ip":"string","provisioning_url":"string","rtp_port_range":"string","sip_port":"number"}]},"provisioning_ip_address":{"value":"10.100.100.11","type":"string"},"provisioning_server_name":{"value":"asterisk-server-provisioning","type":"string"},"provisioning_url":{"value":"http://10.100.100.11","type":"string"},"quick_start_commands":{"value":"# Connect to Asterisk console\nincus exec asterisk-server -- asterisk -rvvv\n    \n# View Asterisk logs\nincus exec asterisk-server -- tail -f /var/log/asterisk/messages\n    \n# Check endpoints\nincus exec asterisk-server -- asterisk -rx \"pjsip show endpoints\"\n    \n# Access provisioning server\ncurl http://10.100.100.11\n    \n# Restart Asterisk\nincus restart asterisk-server\n    \n# Restart provisioning server\nincus restart asterisk-server-provisioning\n","type":"string"},"sip_uri":{"value":"sip:10.100.100.10:5060","type":"string"}},"resources":[{"mode":"managed","type":"incus_instance","name":"asterisk_server","provider":"provider[\"registry.opentofu.org/lxc/incus\"]","instances":[{"schema_version":0,"attributes":{"architecture":"x86_64","config":{"boot.autostart":"true","environment.ASTERISK_GID":"1000","environment.ASTERISK_UID":"1000","limits.cpu":"4","limits.memory":"4GB","security.nesting":"false","security.privileged":"false"},"description":"","device":[{"name":"asterisk-config","properties":{"path":"/etc/asterisk","source":"/home/balou/Documents/Asterisk-POC/asterisk"},"type":"disk"},{"name":"eth0","properties":{"ipv4.address":"10.100.100.10","network":"asterisk-net"},"type":"nic"}],"ephemeral":false,"file":[],"image":"asterisk-latest","ipv4_address":"10.100.100.10","ipv6_address":null,"mac_address":"10:66:6a:56:78:f1","name":"asterisk-server","profiles":["default"],"project":null,"remote":null,"running":true,"source_file":null,"source_instance":null,"status":"Running","target":"","type":"container","wait_for":[]},"sensitive_attributes":[],"dependencies":["incus_network.asterisk_network"]}]},{"mode":"managed","type":"incus_instance","name":"provisioning_server","provider":"provider[\"registry.opentofu.org/lxc/incus\"]","instances":[{"schema_version":0,"attributes":{"architecture":"x86_64","config":{"boot.autostart":"true","limits.cpu":"1","limits.memory":"512MB"},"description":"","device":[{"name":"eth0","properties":{"ipv4.address":"10.100.100.11","network":"asterisk-net"},"type":"nic"},{"name":"www","properties":{"path":"/usr/share/nginx/html","source":"/home/balou/Documents/Asterisk-POC/asterisk/provisioning"},"type":"disk"}],"ephemeral":false,"file":[],"image":"nginx-alpine","ipv4_address":"10.100.100.11","ipv6_address":null,"mac_address":"10:66:6a:3d:e7:4a","name":"asterisk-server-provisioning","profiles":["default"],"project":null,"remote":null,"running":true,"source_file":null,"source_instance":null,"status":"Running","target":"","type":"container","wait_for":[]},"sensitive_attributes":[],"dependencies":["incus_network.asterisk_network"]}]},{"mode":"managed","type":"incus_instance","name":"test_client_1","provider":"provider[\"registry.opentofu.org/lxc/incus\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"architecture":"x86_64","config":{"boot.autostart":"false","cloud-init.user-data":"#cloud-config\npackage_update: true\npackage_upgrade: true\n\npackages:\n  - xfce4\n  - xfce4-goodies\n  - lightdm\n  - firefox-esr\n  - pulseaudio\n  - pavucontrol\n  - alsa-utils\n  - wget\n  - curl\n  - snapd\n\nruncmd:\n  # Enable and start display manager\n  - systemctl enable lightdm\n  - systemctl set-default graphical.target\n\n  # Create test user\n  - useradd -m -s /bin/bash -G audio,video testuser\n  - echo 'testuser:testpass' | chpasswd\n  - usermod -aG sudo testuser\n\n  # Install Zoiper via snap\n  - snap install zoiper5\n\n  # Create Zoiper config for extension 1000\n  - mkdir -p /home/testuser/.Zoiper5\n  - |\n    cat \u003e /home/testuser/.Zoiper5/config.xml \u003c\u003cEOF\n    \u003c?xml version=\"1.0\"?\u003e\n    \u003coptions\u003e\n      \u003caccount\u003e\n        \u003cusername\u003e1000\u003c/username\u003e\n        \u003cpassword\u003eTestPass1000\u003c/password\u003e\n        \u003cdomain\u003e10.100.100.10\u003c/domain\u003e\n        \u003cname\u003eExtension 1000\u003c/name\u003e\n      \u003c/account\u003e\n    \u003c/options\u003e\n    EOF\n  - chown -R testuser:testuser /home/testuser/.Zoiper5\n\n  # Create desktop shortcut\n  - mkdir -p /home/testuser/Desktop\n  - |\n    cat \u003e /home/testuser/Desktop/zoiper.desktop \u003c\u003cEOF\n    [Desktop Entry]\n    Version=1.0\n    Type=Application\n    Name=Zoiper5\n    Exec=zoiper5\n    Icon=zoiper5\n    Terminal=false\n    EOF\n  - chmod +x /home/testuser/Desktop/zoiper.desktop\n  - chown testuser:testuser /home/testuser/Desktop/zoiper.desktop\n\n  # Create README on desktop\n  - |\n    cat \u003e /home/testuser/Desktop/README.txt \u003c\u003cEOF\n    ========================================\n    Asterisk Test Client 1\n    ========================================\n\n    Extension: 1000\n    Password: TestPass1000\n    Asterisk Server: 10.100.100.10\n\n    Login:\n    - Username: testuser\n    - Password: testpass\n\n    Zoiper is pre-configured!\n    Just launch it from the desktop.\n\n    Test calls:\n    - Dial 1001 to call Test Client 2\n    - Dial *43 for echo test\n    - Dial *60 for speaking clock\n    - Dial 8000 for conference room\n    ========================================\n    EOF\n  - chown testuser:testuser /home/testuser/Desktop/README.txt\n\n  # Reboot to apply all changes\n  - reboot\n","limits.cpu":"2","limits.memory":"2GB","security.secureboot":"false"},"description":"","device":[{"name":"eth0","properties":{"ipv4.address":"10.100.100.20","network":"asterisk-net"},"type":"nic"}],"ephemeral":false,"file":[],"image":"images:debian/12","ipv4_address":null,"ipv6_address":null,"mac_address":"10:66:6a:ed:c8:a4","name":"asterisk-test-client-1","profiles":["default"],"project":null,"remote":null,"running":true,"source_file":null,"source_instance":null,"status":"Running","target":"","type":"virtual-machine","wait_for":[]},"sensitive_attributes":[],"dependencies":["incus_network.asterisk_network"]}]},{"mode":"managed","type":"incus_instance","name":"test_client_2","provider":"provider[\"registry.opentofu.org/lxc/incus\"]","instances":[{"index_key":0,"schema_version":0,"attributes":{"architecture":"x86_64","config":{"boot.autostart":"false","cloud-init.user-data":"#cloud-config\npackage_update: true\npackage_upgrade: true\n\npackages:\n  - xfce4\n  - xfce4-goodies\n  - lightdm\n  - firefox-esr\n  - pulseaudio\n  - pavucontrol\n  - alsa-utils\n  - wget\n  - curl\n  - snapd\n\nruncmd:\n  # Enable and start display manager\n  - systemctl enable lightdm\n  - systemctl set-default graphical.target\n\n  # Create test user\n  - useradd -m -s /bin/bash -G audio,video testuser\n  - echo 'testuser:testpass' | chpasswd\n  - usermod -aG sudo testuser\n\n  # Install Zoiper via snap\n  - snap install zoiper5\n\n  # Create Zoiper config for extension 1001\n  - mkdir -p /home/testuser/.Zoiper5\n  - |\n    cat \u003e /home/testuser/.Zoiper5/config.xml \u003c\u003cEOF\n    \u003c?xml version=\"1.0\"?\u003e\n    \u003coptions\u003e\n      \u003caccount\u003e\n        \u003cusername\u003e1001\u003c/username\u003e\n        \u003cpassword\u003eTestPass1001\u003c/password\u003e\n        \u003cdomain\u003e10.100.100.10\u003c/domain\u003e\n        \u003cname\u003eExtension 1001\u003c/name\u003e\n      \u003c/account\u003e\n    \u003c/options\u003e\n    EOF\n  - chown -R testuser:testuser /home/testuser/.Zoiper5\n\n  # Create desktop shortcut\n  - mkdir -p /home/testuser/Desktop\n  - |\n    cat \u003e /home/testuser/Desktop/zoiper.desktop \u003c\u003cEOF\n    [Desktop Entry]\n    Version=1.0\n    Type=Application\n    Name=Zoiper5\n    Exec=zoiper5\n    Terminal=false\n    EOF\n  - chmod +x /home/testuser/Desktop/zoiper.desktop\n  - chown testuser:testuser /home/testuser/Desktop/zoiper.desktop\n\n  # Create README on desktop\n  - |\n    cat \u003e /home/testuser/Desktop/README.txt \u003c\u003cEOF\n    ========================================\n    Asterisk Test Client 2\n    ========================================\n\n    Extension: 1001\n    Password: TestPass1001\n    Asterisk Server: 10.100.100.10\n\n    Login:\n    - Username: testuser\n    - Password: testpass\n\n    Zoiper is pre-configured!\n    Just launch it from the desktop.\n\n    Test calls:\n    - Dial 1000 to call Test Client 1\n    - Dial *43 for echo test\n    - Dial *60 for speaking clock\n    - Dial 8000 for conference room\n    ========================================\n    EOF\n  - chown testuser:testuser /home/testuser/Desktop/README.txt\n\n  # Reboot to apply all changes\n  - reboot\n","limits.cpu":"2","limits.memory":"2GB","security.secureboot":"false"},"description":"","device":[{"name":"eth0","properties":{"ipv4.address":"10.100.100.21","network":"asterisk-net"},"type":"nic"}],"ephemeral":false,"file":[],"image":"images:debian/12","ipv4_address":null,"ipv6_address":null,"mac_address":"10:66:6a:cc:79:1e","name":"asterisk-test-client-2","profiles":["default"],"project":null,"remote":null,"running":true,"source_file":null,"source_instance":null,"status":"Running","target":"","type":"virtual-machine","wait_for":[]},"sensitive_attributes":[],"dependencies":["incus_network.asterisk_network"]}]},{"mode":"managed","type":"incus_network","name":"asterisk_network","provider":"provider[\"registry.opentofu.org/lxc/incus\"]","instances":[{"schema_version":0,"attributes":{"config":{"dns.domain":"asterisk.local","dns.mode":"managed","ipv4.address":"10.100.100.1/24","ipv4.nat":"true","ipv6.address":"none"},"description":"","managed":true,"name":"asterisk-net","project":null,"remote":null,"target":null,"type":"bridge"},"sensitive_attributes":[]}]},{"mode":"managed","type":"incus_storage_pool","name":"asterisk_pool","provider":"provider[\"registry.opentofu.org/lxc/incus\"]","instances":[{"schema_version":0,"attributes":{"config":{},"description":"","driver":"dir","name":"asterisk-storage","project":null,"remote":null,"target":null},"sensitive_attributes":[]}]}],"check_results":null}
